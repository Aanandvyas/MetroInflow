{"ast":null,"code":"import React,{useState,useEffect}from'react';import{createClient}from'@supabase/supabase-js';// --- Supabase Configuration ---\n// These should be set in your .env file and are loaded by the React build process.\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SUPABASE_URL=process.env.REACT_APP_SUPABASE_URL;const SUPABASE_ANON_KEY=process.env.REACT_APP_SUPABASE_ANON_KEY;// Initialize the Supabase client once.\n// Add a check to ensure variables are present before creating the client.\nconst supabase=SUPABASE_URL&&SUPABASE_ANON_KEY?createClient(SUPABASE_URL,SUPABASE_ANON_KEY):null;/**\r\n * A custom hook to manage the user's authentication state.\r\n * It provides the current session and loading status.\r\n */export function useAuth(){const[session,setSession]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{if(!supabase){console.error(\"Supabase URL or Anon Key is missing. Authentication is disabled.\");setLoading(false);return;}// Check for an active session on initial load\nsupabase.auth.getSession().then(_ref=>{let{data:{session}}=_ref;setSession(session);setLoading(false);});// Listen for changes in authentication state (e.g., login, logout)\nconst{data:{subscription}}=supabase.auth.onAuthStateChange((_event,session)=>{setSession(session);});// Cleanup the subscription when the component unmounts\nreturn()=>subscription.unsubscribe();},[]);return{session,loading};}/**\r\n * The Login component renders a form for users to sign in with their email and password.\r\n */export default function Login(){const[loading,setLoading]=useState(false);const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const[message,setMessage]=useState('');const handleLogin=async e=>{e.preventDefault();setError('');setMessage('');if(!supabase){setError(\"Authentication is not configured. Please check your environment variables.\");return;}setLoading(true);const{error}=await supabase.auth.signInWithPassword({email:email,password:password});if(error){setError(error.message);}else{setMessage('Login successful!');// The onAuthStateChange listener in useAuth will handle the session update\n// and trigger the App component to re-render with the Dashboard.\n}setLoading(false);};// This component only renders the form. The session check is done in App.jsx\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"KMRL Hub Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-gray-600\",children:\"Access your document dashboard\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 text-sm text-red-700 bg-red-100 rounded-lg\",role:\"alert\",children:error}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 text-sm text-green-700 bg-green-100 rounded-lg\",role:\"alert\",children:message}),/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-6\",onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"block text-sm font-medium text-gray-700\",children:\"Email address\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",name:\"email\",type:\"email\",autoComplete:\"email\",required:true,value:email,onChange:e=>setEmail(e.target.value),className:\"w-full px-3 py-2 mt-1 placeholder-gray-400 border border-gray-300 rounded-md shadow-sm appearance-none focus:outline-none focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"block text-sm font-medium text-gray-700\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",name:\"password\",type:\"password\",autoComplete:\"current-password\",required:true,value:password,onChange:e=>setPassword(e.target.value),className:\"w-full px-3 py-2 mt-1 placeholder-gray-400 border border-gray-300 rounded-md shadow-sm appearance-none focus:outline-none focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading||!supabase,className:\"relative flex justify-center w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md group hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400\",children:loading?'Signing in...':'Sign in'})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-center text-gray-500\",children:\"Note: For this demo, you can sign up directly through the Supabase dashboard.\"})]})});}// You can export the supabase client if other parts of your app need it,\n// for instance, for the logout button in App.jsx\nexport{supabase};","map":{"version":3,"names":["React","useState","useEffect","createClient","jsx","_jsx","jsxs","_jsxs","SUPABASE_URL","process","env","REACT_APP_SUPABASE_URL","SUPABASE_ANON_KEY","REACT_APP_SUPABASE_ANON_KEY","supabase","useAuth","session","setSession","loading","setLoading","console","error","auth","getSession","then","_ref","data","subscription","onAuthStateChange","_event","unsubscribe","Login","email","setEmail","password","setPassword","setError","message","setMessage","handleLogin","e","preventDefault","signInWithPassword","className","children","role","onSubmit","htmlFor","id","name","type","autoComplete","required","value","onChange","target","disabled"],"sources":["W:/Projects/MetroInflow/frontend/src/components/authpage/Login.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\n// --- Supabase Configuration ---\r\n// These should be set in your .env file and are loaded by the React build process.\r\nconst SUPABASE_URL = process.env.REACT_APP_SUPABASE_URL;\r\nconst SUPABASE_ANON_KEY = process.env.REACT_APP_SUPABASE_ANON_KEY;\r\n\r\n// Initialize the Supabase client once.\r\n// Add a check to ensure variables are present before creating the client.\r\nconst supabase = SUPABASE_URL && SUPABASE_ANON_KEY ? createClient(SUPABASE_URL, SUPABASE_ANON_KEY) : null;\r\n\r\n\r\n/**\r\n * A custom hook to manage the user's authentication state.\r\n * It provides the current session and loading status.\r\n */\r\nexport function useAuth() {\r\n    const [session, setSession] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (!supabase) {\r\n            console.error(\"Supabase URL or Anon Key is missing. Authentication is disabled.\");\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        // Check for an active session on initial load\r\n        supabase.auth.getSession().then(({ data: { session } }) => {\r\n            setSession(session);\r\n            setLoading(false);\r\n        });\r\n\r\n        // Listen for changes in authentication state (e.g., login, logout)\r\n        const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\r\n            setSession(session);\r\n        });\r\n\r\n        // Cleanup the subscription when the component unmounts\r\n        return () => subscription.unsubscribe();\r\n    }, []);\r\n\r\n    return { session, loading };\r\n}\r\n\r\n\r\n/**\r\n * The Login component renders a form for users to sign in with their email and password.\r\n */\r\nexport default function Login() {\r\n    const [loading, setLoading] = useState(false);\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [message, setMessage] = useState('');\r\n\r\n    const handleLogin = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setMessage('');\r\n\r\n        if (!supabase) {\r\n            setError(\"Authentication is not configured. Please check your environment variables.\");\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const { error } = await supabase.auth.signInWithPassword({\r\n            email: email,\r\n            password: password,\r\n        });\r\n\r\n        if (error) {\r\n            setError(error.message);\r\n        } else {\r\n            setMessage('Login successful!');\r\n            // The onAuthStateChange listener in useAuth will handle the session update\r\n            // and trigger the App component to re-render with the Dashboard.\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    // This component only renders the form. The session check is done in App.jsx\r\n    return (\r\n        <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\r\n            <div className=\"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-lg\">\r\n                <div className=\"text-center\">\r\n                    \r\n                    <h1 className=\"text-3xl font-bold text-gray-900\">KMRL Hub Login</h1>\r\n                    <p className=\"mt-2 text-gray-600\">Access your document dashboard</p>\r\n                </div>\r\n\r\n                {error && <div className=\"p-3 text-sm text-red-700 bg-red-100 rounded-lg\" role=\"alert\">{error}</div>}\r\n                {message && <div className=\"p-3 text-sm text-green-700 bg-green-100 rounded-lg\" role=\"alert\">{message}</div>}\r\n\r\n                <form className=\"space-y-6\" onSubmit={handleLogin}>\r\n                    <div>\r\n                        <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\r\n                            Email address\r\n                        </label>\r\n                        <input\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            autoComplete=\"email\"\r\n                            required\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            className=\"w-full px-3 py-2 mt-1 placeholder-gray-400 border border-gray-300 rounded-md shadow-sm appearance-none focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\r\n                            Password\r\n                        </label>\r\n                        <input\r\n                            id=\"password\"\r\n                            name=\"password\"\r\n                            type=\"password\"\r\n                            autoComplete=\"current-password\"\r\n                            required\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            className=\"w-full px-3 py-2 mt-1 placeholder-gray-400 border border-gray-300 rounded-md shadow-sm appearance-none focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading || !supabase}\r\n                            className=\"relative flex justify-center w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md group hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400\"\r\n                        >\r\n                            {loading ? 'Signing in...' : 'Sign in'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n                 <p className=\"text-xs text-center text-gray-500\">\r\n                    Note: For this demo, you can sign up directly through the Supabase dashboard.\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n// You can export the supabase client if other parts of your app need it,\r\n// for instance, for the logout button in App.jsx\r\nexport { supabase };\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}